"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[523],{3229:function(t,c,a){a.d(c,{r:function(){return s}});var e=a(65),n=a(3396);const s=t=>{const c=(0,e.oR)(),a=c.state.cartList,s=(t,a,e,n)=>{c.commit("changeCartItemInfo",{shopId:t,productId:a,productInfo:e,num:n})},o=(0,n.Fl)((()=>{const c=a[t]?.productList||{},e={};for(let t in c){const a=c[t];a.count>0&&(e[t]=a)}return e})),r=(0,n.Fl)((()=>{const c=a[t]?.shopName||"";return c})),i=(0,n.Fl)((()=>{const c=a[t]?.productList,e={total:0,price:0,allChecked:!0};if(c)for(let t in c){const a=c[t];e.total+=a.count,a.check&&(e.price+=a.count*a.price),a.count>0&&!a.check&&(e.allChecked=!1)}return e.price=e.price.toFixed(2),e}));return{cartList:a,changeCartItemInfo:s,productList:o,shopName:r,calculations:i}}},9573:function(t,c,a){a.d(c,{Z:function(){return g}});var e=a(3396),n=a(7139);const s={class:"shop"},o=["src"],r={class:"shop__content__title"},i={class:"shop__content-tags"},_={class:"shop__content__tag"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},u={class:"shop__content__highlight"};function p(t,c,a,p,h,m){return(0,e.wg)(),(0,e.iD)("div",s,[(0,e._)("img",{src:a.item.imgUrl,class:"shop__img"},null,8,o),(0,e._)("div",{class:(0,n.C_)({shop__content:!0,"shop__content--bordered":!a.hideBorder})},[(0,e._)("div",r,(0,n.zw)(a.item.name),1),(0,e._)("div",i,[(0,e._)("span",_,"月售："+(0,n.zw)(a.item.sales),1),(0,e._)("span",l,"起送："+(0,n.zw)(a.item.expressLimit),1),(0,e._)("span",d,"基础运费："+(0,n.zw)(a.item.expressPrice),1)]),(0,e._)("p",u,(0,n.zw)(a.item.slogan),1)],2)])}var h={name:"ShopInfo",props:["item","hideBorder"]},m=a(89);const C=(0,m.Z)(h,[["render",p],["__scopeId","data-v-6bf7fc66"]]);var g=C},2796:function(t,c,a){a.r(c),a.d(c,{default:function(){return ft}});var e=a(3396),n=a(9242);const s=t=>((0,e.dD)("data-v-491af189"),t=t(),(0,e.Cn)(),t),o={class:"wrapper"},r={class:"search"},i=s((()=>(0,e._)("div",{class:"search__content"},[(0,e._)("span",{class:"search__content__icon iconfont"},""),(0,e._)("input",{class:"search__content__input",placeholder:"请输入商品名称"})],-1)));function _(t,c,a,s,_,l){const d=(0,e.up)("ShopInfo"),u=(0,e.up)("Content"),p=(0,e.up)("Cart");return(0,e.wg)(),(0,e.iD)("div",o,[(0,e._)("div",r,[(0,e._)("div",{class:"search__back iconfont",onClick:c[0]||(c[0]=(...t)=>s.handleBackClick&&s.handleBackClick(...t))}," "),i]),(0,e.wy)((0,e.Wm)(d,{item:s.item,hideBorder:!0},null,8,["item"]),[[n.F8,s.item.imgUrl]]),(0,e.Wm)(u,{shopName:s.item.name},null,8,["shopName"]),(0,e.Wm)(p)])}var l=a(4870),d=a(2483),u=a(4471),p=a(9573),h=a(7139);const m=t=>((0,e.dD)("data-v-282a6b3a"),t=t(),(0,e.Cn)(),t),C={class:"content"},g={class:"category"},k=["onClick"],I={class:"product"},v=["src"],w={class:"product__item__detail"},f={class:"product__item__title"},b={class:"product__item__sales"},L={class:"product__item__price"},y=m((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),z={class:"product__item__origin"},D={class:"product__number"},U=["onClick"],P=["onClick"];function S(t,c,a,n,s,o){return(0,e.wg)(),(0,e.iD)("div",C,[(0,e._)("div",g,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(n.categories,(t=>((0,e.wg)(),(0,e.iD)("div",{class:(0,h.C_)({category__item:!0,"category__item--active":n.currentTab===t.tab}),key:t.name,onClick:c=>n.handleTabClick(t.tab)},(0,h.zw)(t.name),11,k)))),128))]),(0,e._)("div",I,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(n.list,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("img",{class:"product__item__img",src:t.imgUrl},null,8,v),(0,e._)("div",w,[(0,e._)("h4",f,(0,h.zw)(t.name),1),(0,e._)("p",b,"月售"+(0,h.zw)(t.sales)+"件",1),(0,e._)("p",L,[y,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",z,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",D,[(0,e._)("span",{class:"product__number__minus iconfont",onClick:()=>{n.changeCartItem(n.shopId,t._id,t,-1,a.shopName)}},"",8,U),(0,e.Uk)(" "+(0,h.zw)(n.getProductCartCount(n.shopId,t._id))+" ",1),(0,e._)("span",{class:"product__number__plus iconfont",onClick:()=>{n.changeCartItem(n.shopId,t._id,t,1,a.shopName)}},"",8,P)])])))),128))])])}var T=a(3229),H=a(65);const N=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],B=()=>{const t=(0,l.iH)(N[0].tab),c=c=>{t.value=c};return{currentTab:t,handleTabClick:c}},j=(t,c)=>{const a=(0,l.qj)({list:[]}),n=async()=>{const e=await(0,u.U)(`/api/shop/${c}/products`,{tab:t.value});0===e?.errno&&e?.data?.length&&(a.list=e.data)};(0,e.m0)((()=>{n()}));const{list:s}=(0,l.BK)(a);return{list:s}},F=()=>{const t=(0,H.oR)(),{cartList:c,changeCartItemInfo:a}=(0,T.r)(),e=(c,a)=>{t.commit("changeShopName",{shopId:c,shopName:a})},n=(t,c,n,s,o)=>{a(t,c,n,s),e(t,o)},s=(t,a)=>c?.[t]?.productList?.[a]?.count||0;return{cartList:c,changeCartItem:n,getProductCartCount:s}};var Z={name:"Content",props:["shopName"],setup(){const t=(0,d.yj)(),c=t.params.id,{currentTab:a,handleTabClick:e}=B(),{list:n}=j(a,c),{changeCartItem:s,cartList:o,getProductCartCount:r}=F();return{categories:N,currentTab:a,handleTabClick:e,list:n,cartList:o,shopId:c,changeCartItem:s,getProductCartCount:r}}},K=a(89);const q=(0,K.Z)(Z,[["render",S],["__scopeId","data-v-282a6b3a"]]);var M=q;const W=t=>((0,e.dD)("data-v-366f047f"),t=t(),(0,e.Cn)(),t),Y={class:"cart"},x={key:0,class:"product"},R={class:"product__header"},$=["innerHTML"],O=(0,e.Uk)(" 全选 "),A={class:"product__header__clear"},E=["innerHTML","onClick"],G=["src"],J={class:"product__item__detail"},Q={class:"product__item__title"},V={class:"product__item__price"},X=W((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),tt={class:"product__item__origin"},ct={class:"product__number"},at=["onClick"],et=["onClick"],nt={class:"check"},st={class:"check__icon"},ot={class:"check__icon__tag"},rt={class:"check__info"},it=(0,e.Uk)(" 总计："),_t={class:"check__info__price"},lt={class:"check__btn"},dt=(0,e.Uk)(" 去结算 ");function ut(t,c,a,s,o,r){const i=(0,e.up)("router-link");return(0,e.wg)(),(0,e.iD)(e.HY,null,[s.showCart&&s.calculations.total>0?((0,e.wg)(),(0,e.iD)("div",{key:0,class:"mask",onClick:c[0]||(c[0]=(...t)=>s.handleCartShowChange&&s.handleCartShowChange(...t))})):(0,e.kq)("",!0),(0,e._)("div",Y,[s.showCart&&s.calculations.total>0?((0,e.wg)(),(0,e.iD)("div",x,[(0,e._)("div",R,[(0,e._)("div",{class:"product__header__all",onClick:c[1]||(c[1]=()=>s.setCartItemsChecked(s.shopId))},[(0,e._)("span",{class:"product__header__icon iconfont",innerHTML:s.calculations.allChecked?"":""},null,8,$),O]),(0,e._)("div",A,[(0,e._)("span",{class:"product__header__clear__btn",onClick:c[2]||(c[2]=()=>s.cleanCartProducts(s.shopId))},"清空购物车")])]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.productList,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("div",{class:"product__item__checked iconfont",innerHTML:t.check?"":"",onClick:()=>s.changeCartItemChecked(s.shopId,t._id)},null,8,E),(0,e._)("img",{class:"product__item__img",src:t.imgUrl},null,8,G),(0,e._)("div",J,[(0,e._)("h4",Q,(0,h.zw)(t.name),1),(0,e._)("p",V,[X,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",tt,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",ct,[(0,e._)("span",{class:"product__number__minus iconfont",onClick:()=>{s.changeCartItemInfo(s.shopId,t._id,t,-1)}},"",8,at),(0,e.Uk)(" "+(0,h.zw)(t.count||0)+" ",1),(0,e._)("span",{class:"product__number__plus iconfont",onClick:()=>{s.changeCartItemInfo(s.shopId,t._id,t,1)}},"",8,et)])])))),128))])):(0,e.kq)("",!0),(0,e._)("div",nt,[(0,e._)("div",st,[(0,e._)("img",{src:"http://www.dell-lee.com/imgs/vue3/basket.png",class:"check__icon__img",onClick:c[3]||(c[3]=(...t)=>s.handleCartShowChange&&s.handleCartShowChange(...t))}),(0,e._)("div",ot,(0,h.zw)(s.calculations.total),1)]),(0,e._)("div",rt,[it,(0,e._)("span",_t,"¥ "+(0,h.zw)(s.calculations.price),1)]),(0,e.wy)((0,e._)("div",lt,[(0,e.Wm)(i,{to:{path:`/OrderConfirmation/${s.shopId}`}},{default:(0,e.w5)((()=>[dt])),_:1},8,["to"])],512),[[n.F8,s.calculations.total>0]])])])],64)}const pt=t=>{const c=(0,H.oR)(),{changeCartItemInfo:a,productList:e,calculations:n}=(0,T.r)(t),s=(t,a)=>{c.commit("changeCartItemChecked",{shopId:t,productId:a})},o=t=>{c.commit("cleanCartProducts",{shopId:t})},r=t=>{c.commit("setCartItemsChecked",{shopId:t})};return{calculations:n,productList:e,cleanCartProducts:o,changeCartItemInfo:a,changeCartItemChecked:s,setCartItemsChecked:r}},ht=()=>{const t=(0,l.iH)(!1),c=()=>{t.value=!t.value};return{showCart:t,handleCartShowChange:c}};var mt={name:"Cart",setup(){const t=(0,d.yj)(),c=t.params.id,{calculations:a,productList:e,cleanCartProducts:n,changeCartItemInfo:s,changeCartItemChecked:o,setCartItemsChecked:r}=pt(c),{showCart:i,handleCartShowChange:_}=ht();return{calculations:a,shopId:c,productList:e,cleanCartProducts:n,changeCartItemInfo:s,changeCartItemChecked:o,setCartItemsChecked:r,showCart:i,handleCartShowChange:_}}};const Ct=(0,K.Z)(mt,[["render",ut],["__scopeId","data-v-366f047f"]]);var gt=Ct;const kt=()=>{const t=(0,d.yj)(),c=(0,l.qj)({item:{}}),a=async()=>{const a=await(0,u.U)(`/api/shop/${t.params.id}`);0===a?.errno&&a?.data&&(c.item=a.data)},{item:e}=(0,l.BK)(c);return{item:e,getItemData:a}},It=()=>{const t=(0,d.tv)(),c=()=>{t.back()};return c};var vt={name:"Shop",components:{ShopInfo:p.Z,Content:M,Cart:gt},setup(){const{item:t,getItemData:c}=kt(),a=It();return c(),{item:t,handleBackClick:a}}};const wt=(0,K.Z)(vt,[["render",_],["__scopeId","data-v-491af189"]]);var ft=wt}}]);
//# sourceMappingURL=shop.ce514ebb.js.map