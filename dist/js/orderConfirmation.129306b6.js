"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[32],{3229:function(t,a,n){n.d(a,{r:function(){return r}});var s=n(65),c=n(3396);const r=t=>{const a=(0,s.oR)(),n=a.state.cartList,r=(t,n,s,c)=>{a.commit("changeCartItemInfo",{shopId:t,productId:n,productInfo:s,num:c})},e=(0,c.Fl)((()=>{const a=n[t]?.productList||{},s={};for(let t in a){const n=a[t];n.count>0&&(s[t]=n)}return s})),o=(0,c.Fl)((()=>{const a=n[t]?.shopName||"";return a})),i=(0,c.Fl)((()=>{const a=n[t]?.productList,s={total:0,price:0,allChecked:!0};if(a)for(let t in a){const n=a[t];s.total+=n.count,n.check&&(s.price+=n.count*n.price),n.count>0&&!n.check&&(s.allChecked=!1)}return s.price=s.price.toFixed(2),s}));return{cartList:n,changeCartItemInfo:r,productList:e,shopName:o,calculations:i}}},8485:function(t,a,n){n.r(a),n.d(a,{default:function(){return $}});var s=n(3396);const c={class:"wrapper"};function r(t,a,n,r,e,o){const i=(0,s.up)("TopArea"),_=(0,s.up)("ProductList"),d=(0,s.up)("Order");return(0,s.wg)(),(0,s.iD)("div",c,[(0,s.Wm)(i),(0,s.Wm)(_),(0,s.Wm)(d)])}const e={class:"top"},o={class:"top__header"},i=(0,s.Uk)(" 确认订单 "),_=(0,s.uE)('<div class="top__receiver" data-v-bbb2973a><div class="top__receiver__title" data-v-bbb2973a>收货地址</div><div class="top__receiver__address" data-v-bbb2973a>学府花苑</div><div class="top__receiver__info" data-v-bbb2973a><span class="top__receiver__info__name" data-v-bbb2973a>王先生</span><span class="top__receiver__info__number" data-v-bbb2973a>123456789</span></div><div class="iconfont top__receiver__icon" data-v-bbb2973a></div></div>',1);function d(t,a,n,c,r,d){return(0,s.wg)(),(0,s.iD)("div",e,[(0,s._)("div",o,[(0,s._)("div",{class:"iconfont top__header__back",onClick:a[0]||(a[0]=(...t)=>c.handBackClick&&c.handBackClick(...t))}," "),i]),_])}var l=n(2483),p={name:"TopArea",setup(){const t=(0,l.tv)(),a=()=>{t.back()};return{handBackClick:a}}},u=n(89);const v=(0,u.Z)(p,[["render",d],["__scopeId","data-v-bbb2973a"]]);var m=v,h=n(7139);const f=t=>((0,s.dD)("data-v-5b1843a9"),t=t(),(0,s.Cn)(),t),b={class:"products"},C={class:"products__title"},k={class:"product__wrapper"},w={class:"products__list"},g=["src"],I={class:"products__item__detail"},L={class:"products__item__title"},O={class:"products__item__price"},D=f((()=>(0,s._)("span",{class:"products__item__yen"},"¥ ",-1))),y={class:"products__item__total"},N=f((()=>(0,s._)("span",{class:"products__item__yen"},"¥",-1)));function z(t,a,n,c,r,e){return(0,s.wg)(),(0,s.iD)("div",b,[(0,s._)("div",C,(0,h.zw)(c.shopName),1),(0,s._)("div",k,[(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.productList,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"products__item",key:t._id},[(0,s._)("img",{class:"products__item__img",src:t.imgUrl},null,8,g),(0,s._)("div",I,[(0,s._)("h4",L,(0,h.zw)(t.name),1),(0,s._)("p",O,[(0,s._)("span",null,[D,(0,s.Uk)(" "+(0,h.zw)(t.price)+" x "+(0,h.zw)(t.count),1)]),(0,s._)("span",y,[N,(0,s.Uk)(" "+(0,h.zw)((t.price*t.count).toFixed(2)),1)])])])])))),128))])])])}var F=n(3229),S={name:"ProductList",setup(){const t=(0,l.yj)(),a=t.params.id,{productList:n,shopName:s}=(0,F.r)(a);return{productList:n,shopName:s}}};const U=(0,u.Z)(S,[["render",z],["__scopeId","data-v-5b1843a9"]]);var j=U,Z=n(9242);const x=t=>((0,s.dD)("data-v-60af1f48"),t=t(),(0,s.Cn)(),t),A={class:"order"},B={class:"order__price"},H=(0,s.Uk)("实付金额 "),P=x((()=>(0,s._)("h3",{class:"mask__content__title"},"确定要离开收银台？",-1))),T=x((()=>(0,s._)("p",{class:"mask__content__desc"},"请尽快完成支付，否则将被取消",-1))),W={class:"mask__content__btns"};function R(t,a,n,c,r,e){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",A,[(0,s._)("div",B,[H,(0,s._)("b",null,"￥"+(0,h.zw)(c.calculations.price),1)]),(0,s._)("div",{class:"order__btn",onClick:a[0]||(a[0]=()=>c.handleShowConfirmChange(!0))},"确认订单")]),(0,s.wy)((0,s._)("div",{class:"mask",onClick:a[4]||(a[4]=()=>c.handleShowConfirmChange(!1))},[(0,s._)("div",{class:"mask__content",onClick:a[3]||(a[3]=(0,Z.iM)((()=>{}),["stop"]))},[P,T,(0,s._)("div",W,[(0,s._)("div",{class:"mask__content__btn mask__content__btn--first",onClick:a[1]||(a[1]=()=>c.handleConfirmOrder(!0))},"取消订单"),(0,s._)("div",{class:"mask__content__btn mask__content__btn--last",onClick:a[2]||(a[2]=()=>c.handleConfirmOrder(!1))},"确认订单")])])],512),[[Z.F8,c.showConfirm]])],64)}var Y=n(4870),E=n(65),K=n(4471);const M=(t,a,n)=>{const s=(0,l.tv)(),c=(0,E.oR)(),r=async r=>{const e=[];for(let t in n.value){const a=n.value[t];e.push({id:parseInt(a._id,10),num:a.count})}try{const n=await(0,K.v)("/api/order",{address:1,shopId:t,shopName:a.value,isCanceled:r,products:e});0===n?.errno&&(c.commit("cleanCartData",t),s.push({name:"OrderList"}))}catch(o){}};return{handleConfirmOrder:r}},q=()=>{const t=(0,Y.iH)(!1),a=a=>{t.value=a};return{showConfirm:t,handleShowConfirmChange:a}};var G={name:"Order",setup(){const t=(0,l.yj)(),a=parseInt(t.params.id,10),{calculations:n,shopName:s,productList:c}=(0,F.r)(a),{handleConfirmOrder:r}=M(a,s,c),{showConfirm:e,handleShowConfirmChange:o}=q();return{calculations:n,handleConfirmOrder:r,showConfirm:e,handleShowConfirmChange:o}}};const J=(0,u.Z)(G,[["render",R],["__scopeId","data-v-60af1f48"]]);var Q=J,V={name:"OrderConfirmation",components:{TopArea:m,ProductList:j,Order:Q}};const X=(0,u.Z)(V,[["render",r],["__scopeId","data-v-58bcc96a"]]);var $=X}}]);
//# sourceMappingURL=orderConfirmation.129306b6.js.map